<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pricing - Pool League Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-emerald-900 to-teal-900 min-h-screen">
    
    <!-- Header -->
    <header class="bg-black/20 backdrop-blur-sm border-b border-white/10">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="app.html" class="text-2xl font-black text-white flex items-center gap-2">
                üé± Pool League Manager
            </a>
            <a href="app.html" class="text-white/80 hover:text-white">‚Üê Back to App</a>
        </div>
    </header>

    <!-- Pricing Section -->
    <main class="max-w-6xl mx-auto px-4 py-12">
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-black text-white mb-4">Simple, Transparent Pricing</h1>
            <p class="text-xl text-white/80">Choose the plan that fits your league</p>
        </div>

        <!-- Billing Toggle -->
        <div class="flex justify-center mb-10">
            <div class="bg-white/10 backdrop-blur-sm rounded-full p-1 flex">
                <button id="monthly-btn" onclick="setBilling('monthly')" class="px-6 py-2 rounded-full font-bold transition-all text-white bg-emerald-600">
                    Monthly
                </button>
                <button id="annual-btn" onclick="setBilling('annual')" class="px-6 py-2 rounded-full font-bold transition-all text-white/70 hover:text-white">
                    Annual <span class="text-emerald-400 text-sm">(Save 10%)</span>
                </button>
            </div>
        </div>

        <!-- Pricing Cards -->
        <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
            
            <!-- Basic -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                <div class="bg-slate-100 p-6 text-center">
                    <h2 class="text-2xl font-black text-slate-800">Basic</h2>
                    <p class="text-slate-600 mt-1">For small leagues</p>
                </div>
                <div class="p-6">
                    <div class="text-center mb-6">
                        <span class="text-5xl font-black text-slate-800">$<span id="basic-price">5</span></span>
                        <span class="text-slate-600" id="basic-period">/month</span>
                        <p class="text-sm text-slate-500 mt-1" id="basic-annual-note"></p>
                    </div>
                    
                    <ul class="space-y-3 mb-8">
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>Up to 10 teams</strong></span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Team standings (W/L record)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Top 5 player rankings</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Current season data</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Web form score entry</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Schedule management</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-slate-300 mt-0.5">‚úó</span>
                            <span class="text-slate-400">Photo scoresheet upload</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-slate-300 mt-0.5">‚úó</span>
                            <span class="text-slate-400">Historical seasons</span>
                        </li>
                    </ul>
                    
                    <button onclick="selectPlan('basic')" class="w-full py-3 bg-slate-200 text-slate-800 font-bold rounded-lg hover:bg-slate-300 transition-colors">
                        Select Basic
                    </button>
                </div>
            </div>

            <!-- Pro (Popular) -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden ring-4 ring-emerald-500 transform md:scale-105">
                <div class="bg-emerald-600 p-6 text-center relative">
                    <span class="absolute top-2 right-2 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full">
                        MOST POPULAR
                    </span>
                    <h2 class="text-2xl font-black text-white">Pro</h2>
                    <p class="text-emerald-100 mt-1">For growing leagues</p>
                </div>
                <div class="p-6">
                    <div class="text-center mb-6">
                        <span class="text-5xl font-black text-slate-800">$<span id="pro-price">10</span></span>
                        <span class="text-slate-600" id="pro-period">/month</span>
                        <p class="text-sm text-slate-500 mt-1" id="pro-annual-note"></p>
                    </div>
                    
                    <ul class="space-y-3 mb-8">
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>Up to 20 teams</strong></span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Full team stats (W/L + Games)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Top 20 player rankings</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Player match & game stats</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>3 years</strong> of history</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>Photo scoresheet upload</strong></span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Schedule management</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-slate-300 mt-0.5">‚úó</span>
                            <span class="text-slate-400">Hall of Fame</span>
                        </li>
                    </ul>
                    
                    <button onclick="selectPlan('pro')" class="w-full py-3 bg-emerald-600 text-white font-bold rounded-lg hover:bg-emerald-700 transition-colors">
                        Select Pro
                    </button>
                </div>
            </div>

            <!-- Premium -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                <div class="bg-gradient-to-r from-amber-500 to-orange-500 p-6 text-center">
                    <h2 class="text-2xl font-black text-white">Premium</h2>
                    <p class="text-amber-100 mt-1">For serious leagues</p>
                </div>
                <div class="p-6">
                    <div class="text-center mb-6">
                        <span class="text-5xl font-black text-slate-800">$<span id="premium-price">20</span></span>
                        <span class="text-slate-600" id="premium-period">/month</span>
                        <p class="text-sm text-slate-500 mt-1" id="premium-annual-note"></p>
                    </div>
                    
                    <ul class="space-y-3 mb-8">
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>Unlimited teams</strong></span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Complete team statistics</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>All player</strong> rankings</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Full player statistics</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>All-time</strong> history</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span>Photo scoresheet upload</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>üèÜ Hall of Fame</strong></span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>Head-to-head records</strong></span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-500 mt-0.5">‚úì</span>
                            <span><strong>Trends & analytics</strong></span>
                        </li>
                    </ul>
                    
                    <button onclick="selectPlan('premium')" class="w-full py-3 bg-gradient-to-r from-amber-500 to-orange-500 text-white font-bold rounded-lg hover:from-amber-600 hover:to-orange-600 transition-colors">
                        Select Premium
                    </button>
                </div>
            </div>
        </div>

        <!-- FAQ Section -->
        <div class="mt-16 max-w-3xl mx-auto">
            <h2 class="text-2xl font-black text-white text-center mb-8">Frequently Asked Questions</h2>
            
            <div class="space-y-4">
                <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h3 class="font-bold text-white mb-2">Can I change plans later?</h3>
                    <p class="text-white/70">Yes! You can upgrade anytime. To downgrade, you may need to reduce your team count to fit within the new plan's limits.</p>
                </div>
                
                <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h3 class="font-bold text-white mb-2">What happens to my data if I downgrade?</h3>
                    <p class="text-white/70">Your data is never deleted. If you downgrade and later upgrade again, all your historical data will be accessible.</p>
                </div>
                
                <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h3 class="font-bold text-white mb-2">Is there a free trial?</h3>
                    <p class="text-white/70">Yes! New accounts get a 14-day free trial with Pro features. No credit card required to start.</p>
                </div>
                
                <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h3 class="font-bold text-white mb-2">What payment methods do you accept?</h3>
                    <p class="text-white/70">We accept all major credit cards through Stripe. Annual plans are billed once per year.</p>
                </div>
            </div>
        </div>

        <!-- Feature Comparison Table -->
        <div class="mt-16 max-w-4xl mx-auto">
            <h2 class="text-2xl font-black text-white text-center mb-8">Feature Comparison</h2>
            
            <div class="bg-white rounded-xl overflow-hidden shadow-xl">
                <table class="w-full">
                    <thead class="bg-slate-100">
                        <tr>
                            <th class="px-6 py-4 text-left font-bold text-slate-700">Feature</th>
                            <th class="px-4 py-4 text-center font-bold text-slate-700">Basic</th>
                            <th class="px-4 py-4 text-center font-bold text-emerald-700 bg-emerald-50">Pro</th>
                            <th class="px-4 py-4 text-center font-bold text-amber-700">Premium</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y">
                        <tr>
                            <td class="px-6 py-4 font-medium">Teams</td>
                            <td class="px-4 py-4 text-center">10</td>
                            <td class="px-4 py-4 text-center bg-emerald-50">20</td>
                            <td class="px-4 py-4 text-center">Unlimited</td>
                        </tr>
                        <tr class="bg-slate-50">
                            <td class="px-6 py-4 font-medium">Team Standings</td>
                            <td class="px-4 py-4 text-center">W/L Only</td>
                            <td class="px-4 py-4 text-center bg-emerald-50/50">W/L + Games</td>
                            <td class="px-4 py-4 text-center">Full Stats</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 font-medium">Player Rankings</td>
                            <td class="px-4 py-4 text-center">Top 5</td>
                            <td class="px-4 py-4 text-center bg-emerald-50">Top 20</td>
                            <td class="px-4 py-4 text-center">All Players</td>
                        </tr>
                        <tr class="bg-slate-50">
                            <td class="px-6 py-4 font-medium">Player Detail Stats</td>
                            <td class="px-4 py-4 text-center text-slate-400">‚Äî</td>
                            <td class="px-4 py-4 text-center bg-emerald-50/50">Match & Games</td>
                            <td class="px-4 py-4 text-center">Everything</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 font-medium">Season History</td>
                            <td class="px-4 py-4 text-center">Current Only</td>
                            <td class="px-4 py-4 text-center bg-emerald-50">3 Years</td>
                            <td class="px-4 py-4 text-center">All-Time</td>
                        </tr>
                        <tr class="bg-slate-50">
                            <td class="px-6 py-4 font-medium">Photo Score Upload</td>
                            <td class="px-4 py-4 text-center text-slate-400">‚Äî</td>
                            <td class="px-4 py-4 text-center bg-emerald-50/50 text-emerald-600">‚úì</td>
                            <td class="px-4 py-4 text-center text-emerald-600">‚úì</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 font-medium">Head-to-Head Records</td>
                            <td class="px-4 py-4 text-center text-slate-400">‚Äî</td>
                            <td class="px-4 py-4 text-center bg-emerald-50 text-slate-400">‚Äî</td>
                            <td class="px-4 py-4 text-center text-emerald-600">‚úì</td>
                        </tr>
                        <tr class="bg-slate-50">
                            <td class="px-6 py-4 font-medium">Trends & Analytics</td>
                            <td class="px-4 py-4 text-center text-slate-400">‚Äî</td>
                            <td class="px-4 py-4 text-center bg-emerald-50/50 text-slate-400">‚Äî</td>
                            <td class="px-4 py-4 text-center text-emerald-600">‚úì</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 font-medium">Hall of Fame</td>
                            <td class="px-4 py-4 text-center text-slate-400">‚Äî</td>
                            <td class="px-4 py-4 text-center bg-emerald-50 text-slate-400">‚Äî</td>
                            <td class="px-4 py-4 text-center text-emerald-600">‚úì</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="mt-16 py-8 border-t border-white/10">
        <div class="max-w-6xl mx-auto px-4 text-center text-white/60">
            <p>¬© 2025 Pool League Manager. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Stripe Price IDs
        const STRIPE_PRICES = {
            basic: {
                monthly: 'price_1Suf0HDidS2jVuhadtJLgnLX',
                annual: 'price_1Suf0HDidS2jVuhaYZ3GEQzW'
            },
            pro: {
                monthly: 'price_1SufOZDidS2jVuha7RkjyRXi',
                annual: 'price_1SufOZDidS2jVuhakiQNABxz'
            },
            premium: {
                monthly: 'price_1SufPkDidS2jVuhatY2mAZT1',
                annual: 'price_1SufPkDidS2jVuham4wwGraF'
            }
        };
        
        // Supabase config (same as app.html)
        const SUPABASE_URL = 'https://hprdhlletatixqysqegi.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhwcmRobGxldGF0aXhxeXNxZWdpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgwOTU1NDMsImV4cCI6MjA4MzY3MTU0M30._wrv6ONjG3JRkpA1FDPFkKMSn0bi6vhMiR0UZB40IRk';
        
        let billingPeriod = 'monthly';
        
        function setBilling(period) {
            billingPeriod = period;
            
            // Update toggle buttons
            document.getElementById('monthly-btn').className = period === 'monthly' 
                ? 'px-6 py-2 rounded-full font-bold transition-all text-white bg-emerald-600'
                : 'px-6 py-2 rounded-full font-bold transition-all text-white/70 hover:text-white';
            document.getElementById('annual-btn').className = period === 'annual'
                ? 'px-6 py-2 rounded-full font-bold transition-all text-white bg-emerald-600'
                : 'px-6 py-2 rounded-full font-bold transition-all text-white/70 hover:text-white';
            
            // Update prices
            if (period === 'monthly') {
                document.getElementById('basic-price').textContent = '5';
                document.getElementById('basic-period').textContent = '/month';
                document.getElementById('basic-annual-note').textContent = '';
                
                document.getElementById('pro-price').textContent = '10';
                document.getElementById('pro-period').textContent = '/month';
                document.getElementById('pro-annual-note').textContent = '';
                
                document.getElementById('premium-price').textContent = '20';
                document.getElementById('premium-period').textContent = '/month';
                document.getElementById('premium-annual-note').textContent = '';
            } else {
                document.getElementById('basic-price').textContent = '54';
                document.getElementById('basic-period').textContent = '/year';
                document.getElementById('basic-annual-note').textContent = '$4.50/mo ‚Ä¢ Save $6';
                
                document.getElementById('pro-price').textContent = '108';
                document.getElementById('pro-period').textContent = '/year';
                document.getElementById('pro-annual-note').textContent = '$9/mo ‚Ä¢ Save $12';
                
                document.getElementById('premium-price').textContent = '216';
                document.getElementById('premium-period').textContent = '/year';
                document.getElementById('premium-annual-note').textContent = '$18/mo ‚Ä¢ Save $24';
            }
        }
        
        async function selectPlan(plan) {
            const priceId = STRIPE_PRICES[plan][billingPeriod === 'monthly' ? 'monthly' : 'annual'];
            
            // Show loading state
            const buttons = document.querySelectorAll('button[onclick^="selectPlan"]');
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.style.opacity = '0.5';
            });
            
            try {
                // Call Supabase Edge Function to create checkout session
                const response = await fetch(`${SUPABASE_URL}/functions/v1/create-checkout-session`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
                    },
                    body: JSON.stringify({
                        priceId: priceId,
                        plan: plan,
                        interval: billingPeriod,
                        successUrl: window.location.origin + '/app.html?checkout=success',
                        cancelUrl: window.location.origin + '/pricing.html?checkout=cancelled'
                    })
                });
                
                const data = await response.json();
                
                if (data.url) {
                    // Redirect to Stripe Checkout
                    window.location.href = data.url;
                } else if (data.error) {
                    throw new Error(data.error);
                } else {
                    throw new Error('Failed to create checkout session');
                }
            } catch (error) {
                console.error('Checkout error:', error);
                alert('Unable to start checkout. Please make sure you are logged in and try again.\n\nError: ' + error.message);
                
                // Re-enable buttons
                buttons.forEach(btn => {
                    btn.disabled = false;
                    btn.style.opacity = '1';
                });
            }
        }
        
        // Check for checkout result on page load
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('checkout') === 'cancelled') {
            // Could show a message that checkout was cancelled
            console.log('Checkout was cancelled');
        }
    </script>
</body>
</html>
